<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>黑金帝国·酒吧争夺战</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #0a0a0a;
            color: #fff;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            height: 100vh;
        }
        
        .app-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
            background: #0a0a0a;
            overflow: hidden;
        }
        
        /* 顶部状态栏 */
        .status-bar {
            height: 80px;
            background: linear-gradient(to bottom, #1a1a1a, #000);
            border-bottom: 2px solid #D4AF37;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            position: relative;
            z-index: 100;
            flex-shrink: 0;
        }
        
        .player-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }
        
        .player-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #D4AF37, #8B0000);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #000;
            font-size: 20px;
            border: 3px solid #8B0000;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            flex-shrink: 0;
            cursor: pointer;
        }
        
        .player-stats {
            font-size: 14px;
            min-width: 0;
        }
        
        .player-name {
            font-weight: bold;
            color: #D4AF37;
            font-size: 18px;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .player-faction-badge {
            display: inline-block;
            padding: 2px 8px;
            background: rgba(139, 0, 0, 0.5);
            border-radius: 10px;
            font-size: 11px;
            color: #D4AF37;
            margin-left: 5px;
        }
        
        .leader-badge {
            display: inline-block;
            padding: 2px 8px;
            background: linear-gradient(to bottom, #D4AF37, #9e7c20);
            border-radius: 10px;
            font-size: 11px;
            color: #000;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .player-resources {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }
        
        .resource {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .resource i {
            color: #D4AF37;
            font-size: 18px;
        }
        
        .resource-value {
            font-weight: bold;
        }
        
        /* 游戏计时器 */
        .game-timer {
            font-size: 20px;
            color: #8B0000;
            text-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
        }
        
        /* 主内容区 */
        .main-content {
            flex: 1;
            overflow: hidden;
            position: relative;
            min-height: 0;
        }
        
        /* 页面容器 */
        .page {
            display: none;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
        }
        
        .page.active {
            display: block;
        }
        
        .page-content {
            padding: 15px;
            min-height: 100%;
        }
        
        /* 欢迎页面 */
        .welcome-screen {
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)),
                        url('https://images.unsplash.com/photo-1513104890138-7c749659a591?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80') center/cover;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .logo {
            font-size: 48px;
            color: #D4AF37;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.9);
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 20px;
            color: #8B0000;
            margin-bottom: 40px;
        }
        
        .btn {
            background: linear-gradient(to bottom, #D4AF37, #9e7c20);
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 10px rgba(0,0,0,0.5);
        }
        
        /* 性别选择 */
        .gender-selection {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
        }
        
        .gender-card {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid #D4AF37;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            width: 140px;
        }
        
        .gender-card.selected {
            background: rgba(212, 175, 55, 0.2);
            border-color: #8B0000;
        }
        
        .gender-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .gender-name {
            font-size: 18px;
            font-weight: bold;
            color: #D4AF37;
        }
        
        /* 阵营选择 */
        .faction-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .faction-card {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid #D4AF37;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            position: relative;
        }
        
        .faction-card.selected {
            border-color: #8B0000;
            background: rgba(139, 0, 0, 0.2);
        }
        
        .faction-icon {
            font-size: 30px;
            color: #D4AF37;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .faction-name {
            font-size: 18px;
            font-weight: bold;
            color: #D4AF37;
            margin-bottom: 5px;
            text-align: center;
        }
        
        .faction-desc {
            font-size: 14px;
            color: #ccc;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .faction-skill {
            background: rgba(212, 175, 55, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
        }
        
        .skill-title {
            font-weight: bold;
            color: #D4AF37;
            margin-bottom: 5px;
        }
        
        .skill-desc {
            font-size: 12px;
            color: #ccc;
        }
        
        .leader-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            gap: 10px;
        }
        
        .toggle-label {
            font-size: 16px;
            color: #D4AF37;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #8B0000;
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: #D4AF37;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #00c853;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        /* 名字输入 */
        .name-input {
            width: 100%;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border: 2px solid #D4AF37;
            border-radius: 10px;
            color: #fff;
            font-size: 16px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        /* 头像选择 */
        .avatar-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }
        
        .avatar-option {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid #D4AF37;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
        }
        
        .avatar-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: #333;
            margin: 0 auto 15px;
            border: 3px solid #D4AF37;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }
        
        /* 二维码扫描 */
        .qr-container {
            max-width: 350px;
            margin: 0 auto;
            text-align: center;
            width: 100%;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            background: #fff;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .qr-instruction {
            font-size: 14px;
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        /* 游戏大厅 */
        .dashboard-container {
            padding: 15px;
        }
        
        .team-info {
            background: rgba(139, 0, 0, 0.2);
            border: 2px solid #8B0000;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .team-title {
            font-size: 18px;
            color: #D4AF37;
            margin-bottom: 10px;
        }
        
        .team-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .team-stat {
            background: rgba(0,0,0,0.3);
            border: 1px solid #D4AF37;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 12px;
            color: #999;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #D4AF37;
        }
        
        /* 任务大厅 */
        .task-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
        }
        
        .task-category {
            padding: 8px 15px;
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 20px;
            font-size: 14px;
            color: #999;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .task-category.active {
            background: #D4AF37;
            color: #000;
            font-weight: bold;
        }
        
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .task-card {
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 10px;
            padding: 15px;
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .task-name {
            font-weight: bold;
            font-size: 16px;
            color: #D4AF37;
        }
        
        .task-type {
            font-size: 12px;
            background: rgba(139, 0, 0, 0.3);
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        .task-desc {
            font-size: 14px;
            color: #ccc;
            margin-bottom: 10px;
        }
        
        .task-reward {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #D4AF37;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        /* 特殊能力 */
        .ability-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .ability-card {
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
        }
        
        .ability-icon {
            font-size: 30px;
            margin-bottom: 10px;
            color: #D4AF37;
        }
        
        .ability-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .ability-cost {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            color: #D4AF37;
            margin-bottom: 10px;
        }
        
        /* 关系页面 - 新增样式 */
        .relation-page {
            padding: 15px;
        }
        
        .relation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .relation-title {
            font-size: 28px;
            color: #D4AF37;
        }
        
        .relation-filters {
            display: flex;
            gap: 10px;
        }
        
        .filter-btn {
            padding: 8px 15px;
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 20px;
            font-size: 14px;
            color: #999;
            cursor: pointer;
        }
        
        .filter-btn.active {
            background: #D4AF37;
            color: #000;
            font-weight: bold;
        }
        
        .relation-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .relation-card {
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid #D4AF37;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .relation-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #D4AF37, #8B0000);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .relation-info {
            flex: 1;
            min-width: 0;
        }
        
        .relation-name {
            font-weight: bold;
            font-size: 16px;
            color: #D4AF37;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .relation-type {
            font-size: 12px;
            background: rgba(139, 0, 0, 0.3);
            padding: 3px 8px;
            border-radius: 10px;
            display: inline-block;
        }
        
        .relation-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(212, 175, 55, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: rgba(212, 175, 55, 0.4);
        }
        
        /* 底部导航 */
        .bottom-nav {
            height: 70px;
            background: linear-gradient(to top, #1a1a1a, #000);
            border-top: 2px solid #D4AF37;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: relative;
            z-index: 100;
            flex-shrink: 0;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
            position: relative;
            flex: 1;
            max-width: 80px;
        }
        
        .nav-item.active {
            color: #D4AF37;
        }
        
        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: #D4AF37;
            border-radius: 3px;
        }
        
        .nav-item i {
            font-size: 24px;
        }
        
        .nav-item span {
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 100%;
            text-align: center;
        }
        
        .scan-btn {
            width: 50px;
            height: 50px;
            background: linear-gradient(to bottom, #D4AF37, #9e7c20);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.7);
            transform: translateY(-10px);
            flex-shrink: 0;
        }
        
        /* 模态框 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #1a1a1a;
            border: 3px solid #D4AF37;
            border-radius: 20px;
            padding: 25px;
            max-width: 380px;
            width: 100%;
            text-align: center;
        }
        
        .modal-title {
            font-size: 22px;
            color: #D4AF37;
            margin-bottom: 15px;
        }
        
        /* 错误提示 */
        .error-hint {
            color: #ff6b6b;
            font-size: 13px;
            margin-top: -15px;
            margin-bottom: 15px;
            display: none;
        }
        
        /* 按钮组 */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .btn-secondary {
            background: linear-gradient(to bottom, #8B0000, #5a0000);
            color: #D4AF37;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .btn-ability {
            background: linear-gradient(to bottom, #8B0000, #5a0000);
            color: #D4AF37;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            margin-top: 5px;
            width: 100%;
        }
        
        .btn-ability:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .warning-text {
            color: #ff6b6b;
            font-size: 12px;
            margin-top: 5px;
            text-align: center;
        }
        
        /* 照片模态框 */
        .photo-modal-content {
            background: #1a1a1a;
            border: 3px solid #D4AF37;
            border-radius: 20px;
            padding: 15px;
            max-width: 90%;
            width: 100%;
            text-align: center;
        }
        
        .member-photo {
            width: 100%;
            border-radius: 10px;
            margin-bottom: 20px;
            max-height: 70vh;
            object-fit: cover;
        }
        
        .photo-details {
            text-align: left;
            margin-bottom: 20px;
        }
        
        .photo-name {
            font-size: 22px;
            color: #D4AF37;
            margin-bottom: 10px;
        }
        
        .photo-title {
            font-size: 16px;
            color: #ccc;
            margin-bottom: 5px;
        }
        
        .photo-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }
        
        .online-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #00c853;
            display: inline-block;
        }
        
        .offline-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ff6b6b;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 顶部状态栏 -->
        <div class="status-bar" id="statusBar" style="display: none;">
            <div class="player-info">
                <div class="player-avatar" id="playerAvatar">A</div>
                <div class="player-stats">
                    <div class="player-name">
                        <span id="playerName">玩家</span>
                        <span class="player-faction-badge" id="factionBadge">黑帮</span>
                        <span class="leader-badge" id="leaderBadge" style="display:none;">帮主</span>
                    </div>
                    <div class="player-resources">
                        <div class="resource">
                            <i class="ri-coin-line"></i>
                            <span class="resource-value" id="playerCoins">1000</span>
                        </div>
                        <div class="resource">
                            <i class="ri-bar-chart-line"></i>
                            <span class="resource-value" id="playerStock">5</span>%
                        </div>
                    </div>
                </div>
            </div>
            <div class="top-controls">
                <div class="game-timer" id="gameTimer">02:59:59</div>
                <button class="btn btn-small" id="factionSkillBtn" style="display:none;">
                    <i class="ri-sword-line"></i> 阵营技能
                </button>
            </div>
        </div>
        
        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 欢迎页面 -->
            <div class="page active" id="welcomePage">
                <div class="welcome-screen">
                    <div>
                        <h1 class="logo">黑金帝国</h1>
                        <p class="subtitle">酒吧争夺战</p>
                        <p style="font-size: 14px; margin-bottom: 30px; color: #ccc;">
                            1933 · 禁酒令时代的权力游戏
                        </p>
                        <button class="btn" onclick="switchPage('genderPage')">开始游戏</button>
                    </div>
                </div>
            </div>
            
            <!-- 性别选择 -->
            <div class="page" id="genderPage">
                <div style="width: 100%; max-width: 350px; margin: 0 auto; text-align: center;">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px;">选择性别</h2>
                    
                    <div class="gender-selection">
                        <div class="gender-card" onclick="selectGender('male', this)">
                            <div class="gender-icon">♂️</div>
                            <div class="gender-name">男性</div>
                        </div>
                        
                        <div class="gender-card" onclick="selectGender('female', this)">
                            <div class="gender-icon">♀️</div>
                            <div class="gender-name">女性</div>
                        </div>
                    </div>
                    
                    <div class="error-hint" id="genderHint">请选择性别</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="switchPage('welcomePage')">返回</button>
                        <button class="btn" onclick="confirmGender()">下一步</button>
                    </div>
                </div>
            </div>
            
            <!-- 阵营选择 -->
            <div class="page" id="factionPage">
                <div style="width: 100%; max-width: 400px; margin: 0 auto;">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px; text-align: center;">选择阵营</h2>
                    
                    <div class="faction-grid">
                        <div class="faction-card" onclick="selectFaction('gang', this)">
                            <div class="faction-icon">🔫</div>
                            <div class="faction-name">黑帮</div>
                            <div class="faction-desc">地下世界的掌控者</div>
                            <div class="faction-skill">
                                <div class="skill-title">强行改变对决结果</div>
                                <div class="skill-desc">当本阵营玩家参与的个人对决结束后结算前，帮主可以强行将结果修改为对本方有利（最多3次）</div>
                            </div>
                        </div>
                        
                        <div class="faction-card" onclick="selectFaction('politician', this)">
                            <div class="faction-icon">🎩</div>
                            <div class="faction-name">政客</div>
                            <div class="faction-desc">权力游戏的操纵者</div>
                            <div class="faction-skill">
                                <div class="skill-title">强制没收财产</div>
                                <div class="skill-desc">帮主可以在任意时间发动此技能，强制没收某阵营四分之一财产（仅限1次）</div>
                            </div>
                        </div>
                        
                        <div class="faction-card" onclick="selectFaction('smuggler', this)">
                            <div class="faction-icon">📦</div>
                            <div class="faction-name">走私商</div>
                            <div class="faction-desc">地下经济的流通者</div>
                            <div class="faction-skill">
                                <div class="skill-title">金币惩罚减半</div>
                                <div class="skill-desc">当本阵营玩家面临金币减少时，帮主可以使该玩家本次应扣金币减少一半（最多3次）</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="leader-toggle">
                        <span class="toggle-label">我愿意成为帮主</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="willingToBeLeader">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="error-hint" id="factionHint">请选择阵营</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="switchPage('genderPage')">上一步</button>
                        <button class="btn" onclick="confirmFaction()">下一步</button>
                    </div>
                </div>
            </div>
            
            <!-- 名字输入页面 -->
            <div class="page" id="namePage">
                <div style="width: 100%; max-width: 350px; margin: 0 auto; text-align: center;">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px;">输入名字</h2>
                    
                    <p style="margin-bottom: 20px; color: #ccc; font-size: 14px;">给你的角色起个名字吧！</p>
                    <input type="text" class="name-input" id="nameInput" placeholder="输入你的名字" maxlength="12">
                    
                    <div class="error-hint" id="nameHint">请输入名字（至少2个字符）</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="switchPage('factionPage')">上一步</button>
                        <button class="btn" onclick="confirmName()">下一步</button>
                    </div>
                </div>
            </div>
            
            <!-- 头像选择页面 -->
            <div class="page" id="avatarPage">
                <div style="width: 100%; max-width: 350px; margin: 0 auto; text-align: center;">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px;">选择头像</h2>
                    
                    <div class="avatar-preview" id="avatarPreview">👤</div>
                    
                    <div class="avatar-options">
                        <div class="avatar-option" onclick="selectAvatar('default')">
                            <i class="ri-user-line"></i>
                            <div>使用默认头像</div>
                        </div>
                        <div class="avatar-option" onclick="selectAvatar('upload')">
                            <i class="ri-upload-cloud-2-line"></i>
                            <div>从相册上传</div>
                        </div>
                    </div>
                    
                    <div class="error-hint" id="avatarHint">请选择头像</div>
                    
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="switchPage('namePage')">上一步</button>
                        <button class="btn" onclick="confirmAvatar()">下一步</button>
                    </div>
                </div>
            </div>
            
            <!-- 二维码扫描页面 -->
            <div class="page" id="qrPage">
                <div class="qr-container">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px;">扫描桌面二维码</h2>
                    
                    <p class="qr-instruction">
                        请扫描您所在桌面的二维码，以便系统确认您的位置。<br>
                        这将帮助我们为您提供更好的社交体验。
                    </p>
                    
                    <div class="qr-code">
                        <!-- 二维码占位符 -->
                        <div style="color: #000; font-size: 14px;">桌号二维码</div>
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="switchPage('avatarPage')">上一步</button>
                        <button class="btn" onclick="confirmQRCode()">已完成扫描</button>
                    </div>
                </div>
            </div>
            
            <!-- 游戏大厅 -->
            <div class="page" id="dashboardPage">
                <div class="dashboard-container">
                    <div class="team-info">
                        <div class="team-title">5号桌 · 黑帮阵营</div>
                        <div class="team-stats">
                            <div class="team-stat">
                                <div class="stat-label">团队金币总值</div>
                                <div class="stat-value">12,450</div>
                            </div>
                            <div class="team-stat">
                                <div class="stat-label">团队活跃度</div>
                                <div class="stat-value">87%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="color: #D4AF37; font-size: 16px; margin-bottom: 10px;">所有桌号团队</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                        <div style="background: rgba(26,26,26,0.9); border: 2px solid #D4AF37; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 24px; color: #D4AF37; margin-bottom: 5px;">1号桌</div>
                            <div style="font-size: 12px; color: #ccc;">金币: 8,500</div>
                        </div>
                        <div style="background: rgba(26,26,26,0.9); border: 2px solid #D4AF37; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 24px; color: #D4AF37; margin-bottom: 5px;">2号桌</div>
                            <div style="font-size: 12px; color: #ccc;">金币: 9,200</div>
                        </div>
                        <div style="background: rgba(26,26,26,0.9); border: 2px solid #D4AF37; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 24px; color: #D4AF37; margin-bottom: 5px;">3号桌</div>
                            <div style="font-size: 12px; color: #ccc;">金币: 12,450</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 任务大厅 -->
            <div class="page" id="taskPage">
                <div class="page-content">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px; text-align: center;">任务大厅</h2>
                    
                    <div class="task-categories">
                        <div class="task-category active">全部任务</div>
                        <div class="task-category">线上对决</div>
                        <div class="task-category">线下任务</div>
                    </div>
                    
                    <div class="task-list">
                        <div class="task-card">
                            <div class="task-header">
                                <div class="task-name">石头剪子布对决</div>
                                <div class="task-type">线上</div>
                            </div>
                            <div class="task-desc">支付100金币参与对决，获胜可获得200金币</div>
                            <div class="task-reward">
                                <i class="ri-coin-line"></i> 200金币
                            </div>
                            <button class="btn" style="width: 100%;">开始对决</button>
                        </div>
                        
                        <div class="task-card">
                            <div class="task-header">
                                <div class="task-name">摇骰子比大小</div>
                                <div class="task-type">线上</div>
                            </div>
                            <div class="task-desc">支付100金币参与对决，获胜可获得200金币</div>
                            <div class="task-reward">
                                <i class="ri-coin-line"></i> 200金币
                            </div>
                            <button class="btn" style="width: 100%;">开始对决</button>
                        </div>
                        
                        <div class="task-card">
                            <div class="task-header">
                                <div class="task-name">寻找异性合影</div>
                                <div class="task-type">线下</div>
                            </div>
                            <div class="task-desc">找到一位异性玩家并完成贴脸合影</div>
                            <div class="task-reward">
                                <i class="ri-coin-line"></i> 200金币
                            </div>
                            <button class="btn" style="width: 100%;">接受任务</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 特殊能力 -->
            <div class="page" id="abilityPage">
                <div class="page-content">
                    <h2 style="font-size: 28px; color: #D4AF37; margin-bottom: 20px; text-align: center;">特殊能力</h2>
                    <p style="text-align: center; margin-bottom: 20px; color: #ccc;">使用金币购买强大技能</p>
                    
                    <div class="ability-grid" id="abilityGrid">
                        <!-- 能力卡片由JS动态生成 -->
                    </div>
                </div>
            </div>
            
            <!-- 关系页面 - 替换原商店页面 -->
            <div class="page" id="relationPage">
                <div class="relation-page">
                    <div class="relation-header">
                        <h2 class="relation-title">帮派关系</h2>
                        <div class="relation-filters">
                            <div class="filter-btn active">全部</div>
                            <div class="filter-btn">家族</div>
                            <div class="filter-btn">核心成员</div>
                        </div>
                    </div>
                    
                    <div class="relation-list" id="relationList">
                        <!-- 帮派成员列表由JS动态生成 -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 底部导航 -->
        <div class="bottom-nav" id="bottomNav" style="display: none;">
            <div class="nav-item active" onclick="switchPage('dashboardPage', this)">
                <i class="ri-home-4-line"></i>
                <span>大厅</span>
            </div>
            <div class="nav-item" onclick="switchPage('taskPage', this)">
                <i class="ri-todo-line"></i>
                <span>任务</span>
            </div>
            <div class="scan-btn" onclick="scanQRCode()">
                <i class="ri-qr-scan-line"></i>
            </div>
            <div class="nav-item" onclick="switchPage('abilityPage', this)">
                <i class="ri-flashlight-line"></i>
                <span>能力</span>
            </div>
            <div class="nav-item" onclick="switchPage('relationPage', this)">
                <i class="ri-group-line"></i>
                <span>关系</span>
            </div>
        </div>
    </div>
    
    <!-- 技能确认弹窗 -->
    <div class="modal" id="skillModal">
        <div class="modal-content">
            <h3 class="modal-title" id="skillTitle">发动阵营技能</h3>
            <p id="skillDescription" style="margin-bottom: 20px; line-height: 1.5;">技能描述内容...</p>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-secondary" style="flex:1;" onclick="closeModal('skillModal')">取消</button>
                <button class="btn" style="flex:1;" id="confirmSkillBtn">确认发动</button>
            </div>
        </div>
    </div>
    
    <!-- 照片查看弹窗 -->
    <div class="modal" id="photoModal">
        <div class="photo-modal-content">
            <img class="member-photo" id="memberPhoto" src="" alt="成员照片">
            <div class="photo-details">
                <div class="photo-name" id="photoName">托尼·索普拉诺</div>
                <div class="photo-title" id="photoTitle">帮派副手</div>
                <div class="photo-status" id="photoStatus">
                    <span class="online-dot"></span> 在线
                </div>
            </div>
            <button class="btn" onclick="closeModal('photoModal')">返回</button>
        </div>
    </div>
    
    <!-- 私聊弹窗 -->
    <div class="modal" id="chatModal">
        <div class="modal-content">
            <h3 class="modal-title">与 <span id="chatTarget">托尼·索普拉诺</span> 私聊</h3>
            <div style="height: 300px; overflow-y: auto; margin-bottom: 20px; border: 1px solid #D4AF37; border-radius: 10px; padding: 10px; background: rgba(0,0,0,0.3);" id="chatHistory">
                <!-- 聊天记录 -->
            </div>
            <div style="display: flex; gap: 10px;">
                <input type="text" placeholder="输入消息..." style="flex:1; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid #D4AF37; border-radius: 10px; color: #fff;">
                <button class="btn">发送</button>
            </div>
            <button class="btn btn-secondary" style="margin-top: 15px; width: 100%;" onclick="closeModal('chatModal')">关闭</button>
        </div>
    </div>
    
    <script>
        // 游戏状态
        let gameState = {
            player: {
                gender: null,
                faction: null,
                isLeader: false,
                name: '',
                avatar: '👤',
                coins: 1000,
                stock: 5,
                tableNumber: null,
                skills: []
            },
            currentPage: 'welcomePage',
            selectedGender: null,
            selectedFaction: null,
            selectedDrink: null,
            selectedAbility: null,
            
            // 帮派成员数据
            gangMembers: [
                {
                    id: 'm1',
                    name: '托尼·索普拉诺',
                    avatar: '👨‍💼',
                    relation: '副手',
                    title: '帮派副手',
                    online: true,
                    photo: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1887&q=80'
                },
                {
                    id: 'm2',
                    name: '卡梅拉·索普拉诺',
                    avatar: '👩‍🦰',
                    relation: '妻子',
                    title: '帮派夫人',
                    online: true,
                    photo: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80'
                },
                {
                    id: 'm3',
                    name: '保利·沃尔纳特',
                    avatar: '👨‍🦱',
                    relation: '兄弟',
                    title: '核心成员',
                    online: true,
                    photo: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1887&q=80'
                },
                {
                    id: 'm4',
                    name: '克里斯托弗·莫尔蒂桑蒂',
                    avatar: '👨‍🎤',
                    relation: '表弟',
                    title: '打手',
                    online: false,
                    photo: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1887&q=80'
                },
                {
                    id: 'm5',
                    name: '西尔维奥·但丁',
                    avatar: '👨‍💼',
                    relation: '顾问',
                    title: '军师',
                    online: true,
                    photo: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1964&q=80'
                },
                {
                    id: 'm6',
                    name: '菲比·拉·盖亚',
                    avatar: '👩‍🦱',
                    relation: '姐姐',
                    title: '家族成员',
                    online: false,
                    photo: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1887&q=80'
                },
                {
                    id: 'm7',
                    name: '菲尔斯·雷欧塔',
                    avatar: '🧔‍♂️',
                    relation: '叔叔',
                    title: '长老',
                    online: true,
                    photo: 'https://images.unsplash.com/photo-1502823403499-6ccfcf4fb453?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1887&q=80'
                },
                {
                    id: 'm8',
                    name: '阿德里亚娜·拉·塞尔瓦',
                    avatar: '👩‍🦳',
                    relation: '线人',
                    title: '情报员',
                    online: true,
                    photo: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1888&q=80'
                }
            ],
            
            // 可用技能池
            skills: [
                { id: 's1', name: '黄金调酒', desc: '购买酒水时获得额外技能加成', price: 300 },
                { id: 's2', name: '股市洞察', desc: '股票交易收益增加20%', price: 400 },
                { id: 's3', name: '谈判专家', desc: '谈判成功率提高30%', price: 350 },
                { id: 's4', name: '策略布局', desc: '每次行动有几率获得额外金币', price: 250 },
                { id: 's5', name: '财富转移', desc: '直接获得目标玩家300金币', price: 450 },
                { id: 's6', name: '社交魅力', desc: '社交互动收益增加25%', price: 320 },
                { id: 's7', name: '暗影行动', desc: '夜间行动不会被发现', price: 380 },
                { id: 's8', name: '双倍收益', desc: '下一次任务奖励翻倍', price: 420 }
            ],
            
            // 可购买的特殊能力
            purchasableAbilities: [
                {
                    id: 'a1',
                    name: '钞能力',
                    icon: '💸',
                    desc: '支付金币获得股权',
                    price: 500,
                    effect: '立即获得5%酒吧股权'
                },
                {
                    id: 'a2',
                    name: '瞬能力',
                    icon: '⚡',
                    desc: '立即获得优势',
                    price: 300,
                    effect: '下一次任务奖励增加50%'
                },
                {
                    id: 'a3',
                    name: '情报网',
                    icon: '📡',
                    desc: '获取对手信息',
                    price: 400,
                    effect: '查看任意对手的金币和股权'
                },
                {
                    id: 'a4',
                    name: '时间扭曲',
                    icon: '⏳',
                    desc: '延长游戏时间',
                    price: 600,
                    effect: '为团队额外获得15分钟游戏时间'
                }
            ]
        };
        
        // 切换页面
        function switchPage(pageId) {
            // 隐藏所有页面
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标页面
            document.getElementById(pageId).classList.add('active');
            gameState.currentPage = pageId;
            
            // 更新导航栏
            if (pageId === 'dashboardPage' || pageId === 'taskPage' ||
                pageId === 'abilityPage' || pageId === 'relationPage') {
                
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                const activeNav = Array.from(document.querySelectorAll('.nav-item')).find(item => {
                    return item.querySelector('span').textContent ===
                        (pageId === 'dashboardPage' ? '大厅' :
                         pageId === 'taskPage' ? '任务' :
                         pageId === 'abilityPage' ? '能力' : '关系');
                });
                
                if (activeNav) activeNav.classList.add('active');
            }
            
            // 如果是关系页面，生成帮派成员列表
            if (pageId === 'relationPage') {
                generateGangRelations();
            }
            
            // 如果是能力页面，生成能力列表
            if (pageId === 'abilityPage') {
                generateAbilityList();
            }
        }
        
        // 生成帮派关系列表
        function generateGangRelations() {
            const list = document.getElementById('relationList');
            list.innerHTML = '';
            
            gameState.gangMembers.forEach(member => {
                const card = document.createElement('div');
                card.className = 'relation-card';
                
                card.innerHTML = `
                    <div class="relation-avatar" onclick="showMemberPhoto('${member.id}')">
                        ${member.avatar}
                    </div>
                    <div class="relation-info">
                        <div class="relation-name">${member.name}</div>
                        <div class="relation-type">${member.relation} · ${member.title}</div>
                    </div>
                    <div class="relation-actions">
                        <div class="action-btn" onclick="startChat('${member.id}')">
                            <i class="ri-message-2-line"></i>
                        </div>
                        <div class="action-btn" onclick="showMemberPhoto('${member.id}')">
                            <i class="ri-eye-line"></i>
                        </div>
                    </div>
                `;
                
                list.appendChild(card);
            });
        }
        
        // 显示成员照片
        function showMemberPhoto(memberId) {
            const member = gameState.gangMembers.find(m => m.id === memberId);
            if (!member) return;
            
            document.getElementById('memberPhoto').src = member.photo;
            document.getElementById('photoName').textContent = member.name;
            document.getElementById('photoTitle').textContent = member.title;
            
            const statusElement = document.getElementById('photoStatus');
            statusElement.innerHTML = member.online ?
                '<span class="online-dot"></span> 在线' :
                '<span class="offline-dot"></span> 离线';
            
            document.getElementById('photoModal').classList.add('active');
        }
        
        // 开始私聊
        function startChat(memberId) {
            const member = gameState.gangMembers.find(m => m.id === memberId);
            if (!member) return;
            
            document.getElementById('chatTarget').textContent = member.name;
            document.getElementById('chatHistory').innerHTML = `
                <div style="text-align: center; color: #999; margin: 10px 0;">
                    开始与 ${member.name} 的对话
                </div>
            `;
            
            document.getElementById('chatModal').classList.add('active');
        }
        
        // 生成能力列表
        function generateAbilityList() {
            const grid = document.getElementById('abilityGrid');
            grid.innerHTML = '';
            
            gameState.purchasableAbilities.forEach(ability => {
                const card = document.createElement('div');
                card.className = 'ability-card';
                
                // 检查玩家是否已拥有此能力
                const hasAbility = gameState.player.skills.some(skill => skill.id === ability.id);
                
                card.innerHTML = `
                    <div class="ability-icon">${ability.icon}</div>
                    <div class="ability-name">${ability.name}</div>
                    <div class="ability-desc">${ability.desc}</div>
                    <div class="ability-cost">
                        <i class="ri-coin-line"></i> ${ability.price}金币
                    </div>
                    <div style="font-size: 12px; color: #ccc; margin-bottom: 10px;">
                        ${ability.effect}
                    </div>
                    <button class="btn-ability" ${hasAbility ? 'disabled' : ''} onclick="purchaseAbility('${ability.id}')">
                        ${hasAbility ? '已购买' : '购买能力'}
                    </button>
                `;
                
                grid.appendChild(card);
            });
        }
        
        // 选择性别
        function selectGender(gender, element) {
            gameState.selectedGender = gender;
            
            // 更新选中状态
            document.querySelectorAll('.gender-card').forEach(card => {
                card.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // 隐藏错误提示
            document.getElementById('genderHint').style.display = 'none';
        }
        
        // 确认性别
        function confirmGender() {
            if (!gameState.selectedGender) {
                document.getElementById('genderHint').style.display = 'block';
                return;
            }
            
            gameState.player.gender = gameState.selectedGender;
            switchPage('factionPage');
        }
        
        // 选择阵营
        function selectFaction(faction, element) {
            gameState.selectedFaction = faction;
            
            // 更新选中状态
            document.querySelectorAll('.faction-card').forEach(card => {
                card.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // 隐藏错误提示
            document.getElementById('factionHint').style.display = 'none';
        }
        
        // 确认阵营
        function confirmFaction() {
            if (!gameState.selectedFaction) {
                document.getElementById('factionHint').style.display = 'block';
                return;
            }
            
            gameState.player.faction = gameState.selectedFaction;
            gameState.player.isLeader = document.getElementById('willingToBeLeader').checked;
            
            // 更新显示
            document.getElementById('factionBadge').textContent =
                gameState.selectedFaction === 'gang' ? '黑帮' :
                gameState.selectedFaction === 'politician' ? '政客' : '走私商';
            
            if (gameState.player.isLeader) {
                document.getElementById('leaderBadge').style.display = 'inline-block';
                document.getElementById('factionSkillBtn').style.display = 'block';
            }
            
            switchPage('namePage');
        }
        
        // 确认名字
        function confirmName() {
            const name = document.getElementById('nameInput').value.trim();
            
            if (name.length < 2) {
                document.getElementById('nameHint').style.display = 'block';
                return;
            }
            
            gameState.player.name = name;
            document.getElementById('playerName').textContent = name;
            switchPage('avatarPage');
        }
        
        // 选择头像
        function selectAvatar(type) {
            gameState.player.avatar = type === 'default' ? '👤' : '🖼️';
            document.getElementById('avatarPreview').textContent = gameState.player.avatar;
            document.getElementById('playerAvatar').textContent = gameState.player.avatar;
            document.getElementById('avatarHint').style.display = 'none';
        }
        
        // 确认头像
        function confirmAvatar() {
            if (!gameState.player.avatar) {
                document.getElementById('avatarHint').style.display = 'block';
                return;
            }
            
            switchPage('qrPage');
        }
        
        // 确认二维码扫描
        function confirmQRCode() {
            // 随机分配桌号
            gameState.player.tableNumber = Math.floor(Math.random() * 12) + 1;
            
            // 显示游戏界面元素
            document.getElementById('statusBar').style.display = 'flex';
            document.getElementById('bottomNav').style.display = 'flex';
            
            // 进入游戏大厅
            switchPage('dashboardPage');
            
            // 开始游戏计时
            startGameTimer();
        }
        
        // 扫描二维码
        function scanQRCode() {
            alert('请扫描桌面二维码绑定桌号');
        }
        
        // 购买能力
        function purchaseAbility(abilityId) {
            const ability = gameState.purchasableAbilities.find(a => a.id === abilityId);
            if (!ability) return;
            
            if (gameState.player.coins < ability.price) {
                alert('金币不足，无法购买此能力');
                return;
            }
            
            // 扣除金币
            gameState.player.coins -= ability.price;
            updatePlayerCoins();
            
            // 添加能力到玩家
            gameState.player.skills.push({
                id: ability.id,
                name: ability.name,
                desc: ability.desc
            });
            
            alert(`成功购买 ${ability.name} 能力！`);
            
            // 刷新能力页面
            generateAbilityList();
        }
        
        // 更新玩家金币显示
        function updatePlayerCoins() {
            document.getElementById('playerCoins').textContent = gameState.player.coins;
        }
        
        // 更新玩家股权显示
        function updatePlayerStock() {
            document.getElementById('playerStock').textContent = gameState.player.stock;
        }
        
        // 显示技能弹窗
        function showFactionSkill() {
            const faction = gameState.player.faction;
            if (!faction) return;
            
            let title = '';
            let description = '';
            
            switch(faction) {
                case 'gang':
                    title = '强行改变对决结果';
                    description = '当本阵营玩家参与的个人对决结束后结算前，你可以发动此技能，强行将结果修改为对本方有利。\n\n剩余使用次数: 3/3';
                    break;
                case 'politician':
                    title = '强制没收财产';
                    description = '你可以在任意时间发动此技能，指定一个阵营，强制没收该阵营所有玩家当前财产的四分之一。\n\n剩余使用次数: 1/1';
                    break;
                case 'smuggler':
                    title = '金币惩罚减半';
                    description = '当本阵营玩家因任何原因面临金币减少时，你可以发动此技能，使该玩家本次应被扣除的金币减少为原数额的一半。\n\n剩余使用次数: 3/3';
                    break;
            }
            
            document.getElementById('skillTitle').textContent = title;
            document.getElementById('skillDescription').textContent = description;
            document.getElementById('skillModal').classList.add('active');
        }
        
        // 关闭弹窗
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // 开始游戏计时
        function startGameTimer() {
            const timerElement = document.getElementById('gameTimer');
            let timeLeft = 3 * 60 * 60; // 3小时（秒）
            
            const updateTimer = () => {
                const hours = Math.floor(timeLeft / 3600);
                const minutes = Math.floor((timeLeft % 3600) / 60);
                const seconds = timeLeft % 60;
                
                timerElement.textContent =
                    `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    endGame();
                    return;
                }
                
                timeLeft--;
                setTimeout(updateTimer, 1000);
            };
            
            updateTimer();
        }
        
        // 游戏结束
        function endGame() {
            alert('游戏结束！正在计算最终结果...');
            // 这里添加结算逻辑
        }
        
        // 初始化事件绑定
        function initEventListeners() {
            document.getElementById('factionSkillBtn').addEventListener('click', showFactionSkill);
            document.getElementById('confirmSkillBtn').addEventListener('click', () => {
                alert('技能发动成功！');
                closeModal('skillModal');
            });
        }
        
        // 页面加载时初始化
        window.onload = function() {
            initEventListeners();
        };
    </script>
</body>
</html>

